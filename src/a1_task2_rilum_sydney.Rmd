---
title: "Principal Components Analysis of Environmental and Climatic Variables"
author: "Sydney Rilum"
date: "1/16/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
library(janitor)
library(here)
library(ggfortify) # for PCA biplot

```

## Introduction

This report performs a principal components analysis (PCA) on various environmental and climatic variables across countries worldwide. PCA is an ordination method that simplifies understanding and analysis of multivariate relationships by approximating original multidimensional space and reducing it to a two dimensional visualization called a biplot.
The data was compiled and provided by @zander_venter on Kaggle and acquired from publicly available remote sensing datasets uploaded to Google Earth Engine. The variables were calculated by taking the mean value for each country at a reduction scale of about 10km. 


## Principal Components Analysis (PCA)

```{r}
# Read in .csv file and clean up column names to lower snake case
world_envi <- read_csv(here("data", "world_env_vars.csv")) %>% 
  clean_names()

```

```{r}
# PCA Data Wrangling
world_pca <- world_envi %>% 
  select(accessibility_to_cities:cloudiness) %>% 
  select(-c("aspect", ends_with("_quart"))) %>%  # deselect aspect variable and variables ending in "_quart"
  drop_na() %>%  # drop observations with an NA value
  scale() %>%  # scale values
  prcomp() # makes data frame into a list of info for PCA

# Create a dataset that drops NAs and contains all variables to use for adding aesthetics to biplot
world_complete <- world_envi %>% 
  drop_na()

# Create a PCA biplot using `autoplot()` function (from ggfortify package)
autoplot(world_pca,
         data = world_complete,
         colour = 'country',
         loadings = TRUE,
         loadings.label = TRUE,  # shows loadings of each variable
         loadings.colour = "gray50",
         loadings.label.colour = "black",
         loadings.label.vjust = -0.75) +
  theme_minimal() +
  theme(legend.position = "none")

# See the loadings (weighting for each principal component)
world_pca$rotation
```

**Figure 1.** Biplot results for the PCA performed on various environmental and climatic variables (indicated by arrows). Length of the line/arrow indicates variance in each principal component (PC1 and PC2) direction, with longer lengths indicating larger variance and the angle between the arrows indicating correlation. The points represent each country included in the study, with the closer the points are to each other the more similar overall in multivariate space.


## Summary

3)  A brief summary (nicely formatted and professionally written bulletpoints are fine) highlighting some major takeaways from your PCA that can be gleaned from the biplot

Biplot results:

The following variables are highly positively correlated, as the angle between their arrows are close to 0 degrees:
- cloudiness and driest month (least amount of rain)
- elevation and wind
- tree canopy cover and ?????????

The following variables are highly negatively correlated, as the angle between their arrows are close to 180 degrees:
- wettest month (rain) and annual temperature range
- 

The following variables are not very correlated since the angle between their arrows are close to 90 or 270 degrees:
- slope and annual temperature range
- temperature seasonality and rain seasonality
- cropland cover and diurnal temperature range
- temperature max warmest month and wettest month/mean annual range
- tree canopy cover and warmest month 










